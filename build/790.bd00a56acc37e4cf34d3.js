"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[790],{7790:(e,n,r)=>{r.r(n),r.d(n,{default:()=>Q});var a,t=r(5893),o=r(4611),i=r(2327),l=r(1150);!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(a||(a={}));var u,c=r(7168),s=(0,c.hg)("profile/fetchProfileData",(function(e,n){return r=void 0,a=void 0,o=function(){var r,a,t,o;return function(e,n){var r,a,t,o,i={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,a&&(t=2&o[0]?a.return:o[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,o[1])).done)return t;switch(a=0,t&&(o=[2&o[0],t.value]),o[0]){case 0:case 1:t=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((t=(t=i.trys).length>0&&t[t.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!t||o[1]>t[0]&&o[1]<t[3])){i.label=o[1];break}if(6===o[0]&&i.label<t[1]){i.label=t[1],t=o;break}if(t&&i.label<t[2]){i.label=t[2],i.ops.push(o);break}t[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],a=0}finally{r=t=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(i){switch(i.label){case 0:r=n.extra,a=n.rejectWithValue,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.api.get("/profile/".concat(e))];case 2:if(!(t=i.sent()).data)throw new Error;return[2,t.data];case 3:return o=i.sent(),console.log(o),[2,a("error")];case 4:return[2]}}))},new((t=void 0)||(t=Promise))((function(e,n){function i(e){try{u(o.next(e))}catch(e){n(e)}}function l(e){try{u(o.throw(e))}catch(e){n(e)}}function u(n){var r;n.done?e(n.value):(r=n.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,l)}u((o=o.apply(r,a||[])).next())}));var r,a,t,o})),d=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.form},f=(0,c.hg)("profile/updateProfileData",(function(e,n){return r=void 0,t=void 0,i=function(){var e,r,t,o,i,l,u;return function(e,n){var r,a,t,o,i={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,a&&(t=2&o[0]?a.return:o[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,o[1])).done)return t;switch(a=0,t&&(o=[2&o[0],t.value]),o[0]){case 0:case 1:t=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((t=(t=i.trys).length>0&&t[t.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!t||o[1]>t[0]&&o[1]<t[3])){i.label=o[1];break}if(6===o[0]&&i.label<t[1]){i.label=t[1],t=o;break}if(t&&i.label<t[2]){i.label=t[2],i.ops.push(o);break}t[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],a=0}finally{r=t=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(c){switch(c.label){case 0:if(e=n.extra,r=n.rejectWithValue,t=n.getState,o=d(t()),(i=function(e){if(!e)return[a.NO_DATA];var n=e.first,r=e.lastname,t=e.age,o=e.country,i=[];return n&&r||i.push(a.INCORRECT_USER_DATA),t&&Number.isInteger(t)||i.push(a.INCORRECT_AGE),o||i.push(a.INCORRECT_COUNTRY),i}(o)).length)return[2,r(i)];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,e.api.put("/profile/".concat(null==o?void 0:o.id),o)];case 2:if(!(l=c.sent()).data)throw new Error;return[2,l.data];case 3:return u=c.sent(),console.log(u),[2,r([a.SERVER_ERROR])];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function a(e){try{u(i.next(e))}catch(e){n(e)}}function l(e){try{u(i.throw(e))}catch(e){n(e)}}function u(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(a,l)}u((i=i.apply(r,t||[])).next())}));var r,t,o,i})),v=function(){return v=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},v.apply(this,arguments)},p=(0,c.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.validateErrors=void 0,e.form=e.data},updateProfile:function(e,n){e.form=v(v({},e.form),n.payload)}},extraReducers:function(e){e.addCase(s.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(s.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})).addCase(s.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})).addCase(f.pending,(function(e){e.validateErrors=void 0,e.isLoading=!0})).addCase(f.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(f.rejected,(function(e,n){e.isLoading=!1,e.validateErrors=n.payload}))}}),h=p.actions,y=p.reducer,g=r(4809),m=r(6925),C=r(4002),b=r(71);!function(e){e.RUB="RUB",e.EUR="EUR",e.USD="USD"}(u||(u={}));var R,N=r(7808),j=r(7294),x=[{value:u.RUB,content:u.RUB},{value:u.EUR,content:u.EUR},{value:u.USD,content:u.USD}],O=(0,j.memo)((function(e){var n=e.className,r=e.value,a=e.onChange,l=e.readonly,u=(0,i.$)().t,c=(0,j.useCallback)((function(e){null==a||a(e)}),[a]);return(0,t.jsx)(N.P,{className:(0,o.A)("",{},[n]),label:u("Укажите валюту"),options:x,value:r,onChange:c,readonly:l},void 0)}));!function(e){e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia"}(R||(R={}));var E=[{value:R.Armenia,content:R.Armenia},{value:R.Russia,content:R.Russia},{value:R.Belarus,content:R.Belarus},{value:R.Kazakhstan,content:R.Kazakhstan},{value:R.Ukraine,content:R.Ukraine}],w=(0,j.memo)((function(e){var n=e.className,r=e.value,a=e.onChange,l=e.readonly,u=(0,i.$)().t,c=(0,j.useCallback)((function(e){null==a||a(e)}),[a]);return(0,t.jsx)(N.P,{className:(0,o.A)("",{},[n]),label:u("Укажите страну"),options:E,value:r,onChange:c,readonly:l},void 0)}));const P={ProfileCard:"wW9jgKKD",input:"ZTyX8_n9",loading:"t07ZxFGs",error:"i5YK3SSb",avatarWrapper:"bEFNSahN",editing:"DjTe7269"};var T=function(){return T=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},T.apply(this,arguments)},A=function(e){var n,r,a=e.className,l=e.data,u=e.isLoading,c=e.error,s=e.readonly,d=e.onChangeFirstname,f=e.onChangeLastname,v=e.onChangeAge,p=e.onChangeCity,h=e.onChangeAvatar,y=e.onChangeUsername,R=e.onChangeCountry,N=e.onChangeCurrency,j=(0,i.$)("profile").t;if(u)return(0,t.jsx)("div",T({className:(0,o.A)(P.ProfileCard,(n={},n[P.loading]=!0,n),[a])},{children:(0,t.jsx)(C.a,{},void 0)}),void 0);if(c)return(0,t.jsx)("div",T({className:(0,o.A)(P.ProfileCard,{},[a,P.error])},{children:(0,t.jsx)(g.xv,{theme:g.lg.ERROR,title:j("Произошла ошибка при загрузке профиля"),text:j("Попробуйте обновить страницу"),align:g.PH.CENTER},void 0)}),void 0);var x=((r={})[P.editing]=!s,r);return(0,t.jsx)("div",T({className:(0,o.A)(P.ProfileCard,x,[a])},{children:(0,t.jsxs)("div",T({className:P.data},{children:[(null==l?void 0:l.avatar)&&(0,t.jsx)("div",T({className:P.avatarWrapper},{children:(0,t.jsx)(b.q,{src:null==l?void 0:l.avatar},void 0)}),void 0),(0,t.jsx)(m.I,{value:null==l?void 0:l.first,placeholder:j("Ваше имя"),className:P.input,onChange:d,readonly:s},void 0),(0,t.jsx)(m.I,{value:null==l?void 0:l.lastname,placeholder:j("Ваша фамилия"),className:P.input,onChange:f,readonly:s},void 0),(0,t.jsx)(m.I,{value:null==l?void 0:l.age,placeholder:j("Ваш возраст"),className:P.input,onChange:v,readonly:s},void 0),(0,t.jsx)(m.I,{value:null==l?void 0:l.city,placeholder:j("Город"),className:P.input,onChange:p,readonly:s},void 0),(0,t.jsx)(m.I,{value:null==l?void 0:l.username,placeholder:j("Введите имя пользователя"),className:P.input,onChange:y,readonly:s},void 0),(0,t.jsx)(m.I,{value:null==l?void 0:l.avatar,placeholder:j("Введите ссылку на аватар"),className:P.input,onChange:h,readonly:s},void 0),(0,t.jsx)(O,{className:P.input,value:null==l?void 0:l.currency,onChange:N,readonly:s},void 0),(0,t.jsx)(w,{className:P.input,value:null==l?void 0:l.country,onChange:R,readonly:s},void 0)]}),void 0)}),void 0)},k=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.isLoading},S=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.data},U=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.error},_=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.readonly},I=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.validateErrors},D=r(5461),L=r(9704),B=r(2276),F=r(6974),W=r(6156),G=r(9161),z=r(3574);const K={ProfilePageHeader:"FPJSgL1_",editBtn:"vP5lJqeW",btnsWrapper:"RSsPrFbn"};var M=function(){return M=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},M.apply(this,arguments)},V=function(e){var n=e.className,r=(0,i.$)("profile").t,a=(0,L.v9)(z.m5),l=(0,L.v9)(S),u=(null==a?void 0:a.id)===(null==l?void 0:l.id),c=(0,L.v9)(_),s=(0,D.T)(),d=(0,j.useCallback)((function(){s(h.setReadonly(!1))}),[s]),v=(0,j.useCallback)((function(){s(h.cancelEdit())}),[s]),p=(0,j.useCallback)((function(){s(f())}),[s]);return(0,t.jsxs)("div",M({className:(0,o.A)(K.ProfilePageHeader,{},[n])},{children:[(0,t.jsx)(g.xv,{title:r("Профиль")},void 0),u&&(0,t.jsx)("div",M({className:K.btnsWrapper},{children:c?(0,t.jsx)(G.zx,M({className:K.editBtn,theme:G.bn.OUTLINE,onClick:d},{children:r("Редактировать")}),void 0):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G.zx,M({className:K.editBtn,theme:G.bn.OUTLINE_RED,onClick:v},{children:r("Отменить")}),void 0),(0,t.jsx)(G.zx,M({className:K.saveBtn,theme:G.bn.OUTLINE,onClick:p},{children:r("Сохранить")}),void 0)]},void 0)}),void 0)]}),void 0)},Y=function(){return Y=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},Y.apply(this,arguments)},q={profile:y};const Q=function(e){var n,r=e.className,u=(0,i.$)("profile").t,c=(0,D.T)(),f=(0,L.v9)(d),v=(0,L.v9)(k),p=(0,L.v9)(U),y=(0,L.v9)(_),m=(0,L.v9)(I),C=(0,F.UO)().id,b=((n={})[a.SERVER_ERROR]=u("Серверная ошибка при сохранении"),n[a.INCORRECT_COUNTRY]=u("Некорректный регион"),n[a.NO_DATA]=u("Данные не указаны"),n[a.INCORRECT_USER_DATA]=u("Имя и фамилия обязательны"),n[a.INCORRECT_AGE]=u("Некорректный возраст"),n);(0,B.Q)((function(){C&&c(s(C))}));var R=(0,j.useCallback)((function(e){c(h.updateProfile({first:e||""}))}),[c]),N=(0,j.useCallback)((function(e){c(h.updateProfile({lastname:e||""}))}),[c]),x=(0,j.useCallback)((function(e){c(h.updateProfile({city:e||""}))}),[c]),O=(0,j.useCallback)((function(e){c(h.updateProfile({age:Number(e||0)}))}),[c]),E=(0,j.useCallback)((function(e){c(h.updateProfile({username:e||""}))}),[c]),w=(0,j.useCallback)((function(e){c(h.updateProfile({avatar:e||""}))}),[c]),P=(0,j.useCallback)((function(e){c(h.updateProfile({currency:e}))}),[c]),T=(0,j.useCallback)((function(e){c(h.updateProfile({country:e}))}),[c]);return(0,t.jsx)(l.W,Y({reducers:q,removeAfterUnmount:!0},{children:(0,t.jsxs)(W.T,Y({className:(0,o.A)("",{},[r])},{children:[(0,t.jsx)(V,{},void 0),(null==m?void 0:m.length)&&m.map((function(e){return(0,t.jsx)(g.xv,{theme:g.lg.ERROR,text:b[e]},e)})),(0,t.jsx)(A,{data:f,isLoading:v,error:p,readonly:y,onChangeFirstname:R,onChangeLastname:N,onChangeAge:O,onChangeCity:x,onChangeUsername:E,onChangeAvatar:w,onChangeCurrency:P,onChangeCountry:T},void 0)]}),void 0)}),void 0)}},1150:(e,n,r)=>{r.d(n,{W:()=>i});var a=r(5893),t=r(7294),o=r(9704),i=function(e){var n=e.children,r=e.reducers,i=e.removeAfterUnmount,l=void 0===i||i,u=(0,o.oR)(),c=(0,o.I0)();return(0,t.useEffect)((function(){var e=u.reducerManager.getMountedReducers();return Object.entries(r).forEach((function(n){var r=n[0],a=n[1];e[r]||(u.reducerManager.add(r,a),c({type:"@INIT ".concat(r," reducer")}))})),function(){l&&Object.entries(r).forEach((function(e){var n=e[0];e[1],u.reducerManager.remove(n),c({type:"@DESTROY ".concat(n," reducer")})}))}}),[]),(0,a.jsx)(a.Fragment,{children:n},void 0)}},71:(e,n,r)=>{r.d(n,{q:()=>i});var a=r(5893),t=r(4611),o=r(7294);var i=function(e){var n=e.className,r=e.src,i=e.size,l=e.alt,u=(0,o.useMemo)((function(){return{width:i||100,height:i||100}}),[i]);return(0,a.jsx)("img",{src:r,alt:l,style:u,className:(0,t.A)("ZqPdwJxd",{},[n])},void 0)}},6925:(e,n,r)=>{r.d(n,{I:()=>l});var a=r(5893),t=r(4611),o=r(7294);var i=function(){return i=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},i.apply(this,arguments)},l=(0,o.memo)((function(e){var n=e.className,r=e.value,l=e.onChange,u=e.type,c=void 0===u?"text":u,s=e.placeholder,d=e.autofocus,f=e.readonly,v=function(e,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(a=Object.getOwnPropertySymbols(e);t<a.length;t++)n.indexOf(a[t])<0&&Object.prototype.propertyIsEnumerable.call(e,a[t])&&(r[a[t]]=e[a[t]])}return r}(e,["className","value","onChange","type","placeholder","autofocus","readonly"]),p=(0,o.useRef)(null),h=(0,o.useState)(!1),y=h[0],g=h[1],m=(0,o.useState)(0),C=m[0],b=m[1],R=y&&!f;return(0,o.useEffect)((function(){var e;d&&(g(!0),null===(e=p.current)||void 0===e||e.focus())}),[d]),{}.fTN1PnWu=f,(0,a.jsxs)("div",i({className:(0,t.A)("LuFDUWoP",{},[n])},{children:[s&&(0,a.jsx)("div",i({className:"emAQQ85i"},{children:"".concat(s,">")}),void 0),(0,a.jsxs)("div",i({className:"y1GiFC_L"},{children:[(0,a.jsx)("input",i({ref:p,type:c,value:r,onChange:function(e){null==l||l(e.target.value),b(e.target.value.length)},className:"LVdIPwcx",onFocus:function(){g(!0)},onBlur:function(){g(!1)},onSelect:function(e){var n;b((null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.selectionStart)||0)},readOnly:f},v),void 0),R&&(0,a.jsx)("span",{className:"lqMFGBuL",style:{left:"".concat(9*C,"px")}},void 0)]}),void 0)]}),void 0)}))},7808:(e,n,r)=>{r.d(n,{P:()=>l});var a=r(5893),t=r(4611),o=r(7294);var i=function(){return i=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},i.apply(this,arguments)},l=function(e){var n=e.className,r=e.label,l=e.options,u=e.onChange,c=e.value,s=e.readonly,d=(0,o.useMemo)((function(){return null==l?void 0:l.map((function(e){return(0,a.jsx)("option",i({className:"JkXz98qY",value:e.value},{children:e.content}),e.value)}))}),[l]);return(0,a.jsxs)("div",i({className:(0,t.A)("cidfdn6H",{},[n])},{children:[r&&(0,a.jsx)("span",i({className:"G1uuf7Bp"},{children:"".concat(r,">")}),void 0),(0,a.jsx)("select",i({disabled:s,className:"VOKOuKGo",value:c,onChange:function(e){u&&u(e.target.value)}},{children:d}),void 0)]}),void 0)}},6156:(e,n,r)=>{r.d(n,{T:()=>v});var a=r(5893),t=r(4611),o=r(7294),i=r(5461),l=(0,r(573).P1)((function(e){return e.ui.scroll}),(function(e,n){return n}),(function(e,n){return e[n]||0})),u=r(7217),c=r(6974),s=r(2276),d=r(9704);var f=function(){return f=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},f.apply(this,arguments)},v=(0,o.memo)((function(e){var n=e.className,r=e.children,v=e.onScrollEnd,p=(0,o.useRef)(),h=(0,o.useRef)(),y=(0,i.T)(),g=(0,c.TH)().pathname,m=(0,d.v9)((function(e){return l(e,g)}));!function(e){var n=e.callback,r=e.wrapperRef,a=e.triggerRef,t=(0,o.useRef)(null);(0,o.useEffect)((function(){var e=r.current,o=a.current;if(n){var i={root:e,rootMargin:"0px",threshold:1};t.current=new IntersectionObserver((function(e){e[0].isIntersecting&&n()}),i),t.current.observe(o)}return function(){t.current&&o&&t.current.unobserve(o)}}),[n,a,r])}({triggerRef:h,wrapperRef:p,callback:v}),(0,s.Q)((function(){p.current.scrollTop=m}));var C,b,R=(C=function(e){y(u.Aw.setScrollPosition({position:e.currentTarget.scrollTop,path:g}))},500,b=(0,o.useRef)(!1),(0,o.useCallback)((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];b.current||(C.apply(void 0,e),b.current=!0,setTimeout((function(){b.current=!1}),500))}),[C,500]));return(0,a.jsxs)("section",f({ref:p,className:(0,t.A)("a83jDcrK",{},[n]),onScroll:R},{children:[r,v?(0,a.jsx)("div",{ref:h,className:"VaPQ__zP"},void 0):null]}),void 0)}))},5461:(e,n,r)=>{r.d(n,{T:()=>t});var a=r(9704),t=function(){return(0,a.I0)()}},2276:(e,n,r)=>{r.d(n,{Q:()=>t});var a=r(7294);function t(e){(0,a.useEffect)((function(){e()}),[])}}}]);