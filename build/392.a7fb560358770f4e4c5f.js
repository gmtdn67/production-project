"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[392],{8950:(e,t,r)=>{r.r(t),r.d(t,{default:()=>V});var a=r(3007),n=r(7294),o=r(1233),i=r(5401),c=r(5420),s=r(5861),l=r(4687),u=r.n(l),d=r(4268),v=r(417),f=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.isLoading)||!1},p=function(e){var t;return null===(t=e.articlesPage)||void 0===t?void 0:t.error},g=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.view)||v.GA.SMALL},h=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.page)||1},m=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.order)||"asc"},y=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.sort)||v.$B.CREATED},j=function(e){var t,r;return null!==(t=null===(r=e.articlesPage)||void 0===r?void 0:r.search)&&void 0!==t?t:""},P=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.type)||v.Iq.ALL},x=r(1283),b=r(9439);var w=(0,d.hg)("articlesPage/fetchArticlesList",function(){var e=(0,s.Z)(u().mark((function e(t,r){var a,n,o,i,c,s,l,d,f,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.extra,n=r.rejectWithValue,u=(o=r.getState)(),void 0,i=(null===(g=u.articlesPage)||void 0===g?void 0:g.limit)||9,c=m(o()),s=y(o()),l=j(o()),d=h(o()),f=P(o()),e.prev=7,t={sort:s,order:c,search:l,type:f},window.history.pushState(null,"",function(e){var t=new URLSearchParams(window.location.search);return Object.entries(e).forEach((function(e){var r=(0,b.Z)(e,2),a=r[0],n=r[1];void 0!==n&&t.set(a,n)})),"?".concat(t.toString())}(t)),e.next=11,a.api.get("/articles",{params:{_expand:"user",_limit:i,_page:d,_sort:s,_order:c,q:l,type:f===v.Iq.ALL?void 0:f}});case 11:if((p=e.sent).data){e.next=14;break}throw new Error;case 14:return e.abrupt("return",p.data);case 17:return e.prev=17,e.t0=e.catch(7),e.abrupt("return",n("error"));case 20:case"end":return e.stop()}var t,u,g}),e,null,[[7,17]])})));return function(t,r){return e.apply(this,arguments)}}()),S=(0,d.HF)({selectId:function(e){return e.id}}),C=S.getSelectors((function(e){return e.articlesPage||S.getInitialState()})),L=(0,d.oM)({name:"articlesPageSlice",initialState:S.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},view:v.GA.SMALL,page:1,hasMore:!0,_inited:!1,limit:9,sort:v.$B.CREATED,search:"",order:"asc",type:v.Iq.ALL}),reducers:{setView:function(e,t){e.view=t.payload,localStorage.setItem(x.f,t.payload)},setPage:function(e,t){e.page=t.payload},setOrder:function(e,t){e.order=t.payload},setSort:function(e,t){e.sort=t.payload},setType:function(e,t){e.type=t.payload},setSearch:function(e,t){e.search=t.payload},initState:function(e){var t=localStorage.getItem(x.f);e.view=t,e.limit=t===v.GA.BIG?4:9,e._inited=!0}},extraReducers:function(e){e.addCase(w.pending,(function(e,t){e.error=void 0,e.isLoading=!0,t.meta.arg.replace&&S.removeAll(e)})).addCase(w.fulfilled,(function(e,t){e.isLoading=!1,e.hasMore=t.payload.length>=e.limit,t.meta.arg.replace?S.setAll(e,t.payload):S.addMany(e,t.payload)})).addCase(w.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}),O=L.reducer,A=L.actions,N=(0,d.hg)("articlesPage/fetchNextArticlesPage",function(){var e=(0,s.Z)(u().mark((function e(t,r){var a,n,o,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.getState,n=r.dispatch,t=a(),void 0,o=null===(s=t.articlesPage)||void 0===s?void 0:s.hasMore,i=h(a()),c=f(a()),o&&!c&&(n(A.setPage(i+1)),n(w({})));case 5:case"end":return e.stop()}var t,s}),e)})));return function(t,r){return e.apply(this,arguments)}}());var k=r(4478),I=r(3942),E=r(8312),T=r(6425),R=r(595);const Z={sortWrapper:"pyOjonnp",search:"QkNSez8q",tabs:"JHbc4jKB"};var _=r(5893),q=function(e){var t,r,o=e.className,c=(0,k.$)().t,s=(0,I.v9)(g),l=(0,i.T)(),u=(0,I.v9)(m),d=(0,I.v9)(y),f=(0,I.v9)(j),p=(0,I.v9)(P),h=(0,n.useCallback)((function(){l(w({replace:!0}))}),[l]),x=(t=h,500,r=(0,n.useRef)(),(0,n.useCallback)((function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];r.current&&clearTimeout(r.current),r.current=setTimeout((function(){t.apply(void 0,a)}),500)}),[t,500])),b=(0,n.useCallback)((function(e){l(A.setView(e)),x()}),[l,x]),S=(0,n.useCallback)((function(e){l(A.setSort(e)),l(A.setPage(1)),x()}),[l,x]),C=(0,n.useCallback)((function(e){l(A.setOrder(e)),l(A.setPage(1)),x()}),[l,x]),L=(0,n.useCallback)((function(e){l(A.setSearch(e)),l(A.setPage(1)),x()}),[l,x]),O=(0,n.useCallback)((function(e){l(A.setType(e)),l(A.setPage(1)),h()}),[l,h]);return(0,_.jsxs)("div",{className:(0,a.A)(Z.ArticlesPageFilters,{},[o]),children:[(0,_.jsxs)("div",{className:Z.sortWrapper,children:[(0,_.jsx)(R.x,{order:u,sort:d,onChangeOrder:C,onChangeSort:S}),(0,_.jsx)(v.Vv,{view:s,onViewClick:b})]}),(0,_.jsx)(T.Z,{className:Z.search,children:(0,_.jsx)(E.I,{placeholder:c("Поиск"),value:f,onChange:L})}),(0,_.jsx)(v.XL,{value:p,onChangeType:O,className:Z.tabs})]})},D=r(9655),M=r(1715),G=function(e){var t=e.className,r=(0,k.$)().t,a=(0,I.v9)(C.selectAll),n=(0,I.v9)(f),o=(0,I.v9)(g),i=(0,I.v9)(p),c=(0,D.lr)();return(0,b.Z)(c,1)[0],i?(0,_.jsx)(M.xv,{text:r("Ошибка при загрузке статей"),theme:M.lg.ERROR}):(0,_.jsx)(v.wD,{isLoading:n,view:o,articles:a,className:t})},B={articlesPage:O},F=function(e){var t=e.className,r=(0,i.T)(),s=(0,n.useCallback)((function(){r(N())}),[r]);return(0,_.jsx)(o.W,{reducers:B,removeAfterUnmount:!1,children:(0,_.jsxs)(c.T,{onScrollEnd:s,className:(0,a.A)("i0h17Gqm",{},[t]),children:[(0,_.jsx)(q,{}),(0,_.jsx)(G,{className:"UsH35LqR"})]})})};const V=(0,n.memo)(F)},8312:(e,t,r)=>{r.d(t,{I:()=>v});var a=r(4942),n=r(9439),o=r(4925),i=r(3007),c=r(7294);var s=r(5893),l=["className","value","onChange","type","placeholder","autofocus","readonly"];function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=(0,c.memo)((function(e){var t=e.className,r=e.value,u=e.onChange,v=e.type,f=void 0===v?"text":v,p=e.placeholder,g=e.autofocus,h=e.readonly,m=(0,o.Z)(e,l),y=(0,c.useRef)(null),j=(0,c.useState)(!1),P=(0,n.Z)(j,2),x=P[0],b=P[1],w=(0,c.useState)(0),S=(0,n.Z)(w,2),C=S[0],L=S[1],O=x&&!h;return(0,c.useEffect)((function(){var e;g&&(b(!0),null===(e=y.current)||void 0===e||e.focus())}),[g]),(0,a.Z)({},"fTN1PnWu",h),(0,s.jsxs)("div",{className:(0,i.A)("LuFDUWoP",{},[t]),children:[p&&(0,s.jsx)("div",{className:"emAQQ85i",children:"".concat(p,">")}),(0,s.jsxs)("div",{className:"y1GiFC_L",children:[(0,s.jsx)("input",d({ref:y,type:f,value:r,onChange:function(e){null==u||u(e.target.value),L(e.target.value.length)},className:"LVdIPwcx",onFocus:function(){b(!0)},onBlur:function(){b(!1)},onSelect:function(e){var t;L((null==e||null===(t=e.target)||void 0===t?void 0:t.selectionStart)||0)},readOnly:h},m)),O&&(0,s.jsx)("span",{className:"lqMFGBuL",style:{left:"".concat(9*C,"px")}})]})]})}))}}]);