"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[517],{2517:function(e,a,r){r.r(a),r.d(a,{default:function(){return I}});var s=r(2327),t=r(9319),n=r(7294),o=r(3007),c=r(5255),l=r(8312),u=r(1715),d=r(1233),i=r(5401);const m=e=>e?.loginForm?.username||"",g=e=>e?.loginForm?.password||"",f=e=>e?.loginForm?.isLoading||!1,h=e=>e?.loginForm?.error;var p=r(4268),v=r(7081),x=r(1283);const j=(0,p.hg)("login/loginByUsername",(async(e,a)=>{const{extra:r,dispatch:s,rejectWithValue:t}=a;try{const a=await r.api.post("/login",e);if(!a.data)throw new Error;return localStorage.setItem(x.z,JSON.stringify(a.data)),s(v.hI.setAuthData(a.data)),a.data}catch(e){return console.log(e),t("error")}})),y=(0,p.oM)({name:"login",initialState:{isLoading:!1,username:"",password:""},reducers:{setUsername:(e,a)=>{e.username=a.payload},setPassword:(e,a)=>{e.password=a.payload}},extraReducers:e=>{e.addCase(j.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(j.fulfilled,(e=>{e.isLoading=!1})).addCase(j.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}}),{actions:N}=y,{reducer:C}=y;var w="PQPa1eB5",E=r(5893);const F={loginForm:C};var I=(0,n.memo)((({className:e,onSuccess:a})=>{const{t:r}=(0,s.$)(),p=(0,i.T)(),v=(0,t.v9)(m),x=(0,t.v9)(g),y=(0,t.v9)(f),C=(0,t.v9)(h),I=(0,n.useCallback)((e=>{p(N.setUsername(e))}),[p]),L=(0,n.useCallback)((e=>{p(N.setPassword(e))}),[p]),S=(0,n.useCallback)((async()=>{"fulfilled"===(await p(j({username:v,password:x}))).meta.requestStatus&&a()}),[a,p,x,v]);return(0,E.jsx)(d.W,{removeAfterUnmount:!0,reducers:F,children:(0,E.jsxs)("div",{className:(0,o.A)("xYNEfcE9",{},[e]),children:[(0,E.jsx)(u.xv,{title:r("Форма авторизации")}),C&&(0,E.jsx)(u.xv,{text:r("Вы ввели неверный логин или пароль"),theme:u.lg.ERROR}),(0,E.jsx)(l.I,{autofocus:!0,type:"text",className:w,placeholder:r("Введите username"),onChange:I,value:v}),(0,E.jsx)(l.I,{type:"text",className:w,placeholder:r("Введите пароль"),onChange:L,value:x}),(0,E.jsx)(c.zx,{theme:c.bn.OUTLINE,className:"Ok_5amJo",onClick:S,disabled:y,children:r("Войти")})]})})}))},1233:function(e,a,r){r.d(a,{W:function(){return o}});var s=r(7294),t=r(9319),n=r(5893);const o=e=>{const{children:a,reducers:r,removeAfterUnmount:o=!0}=e,c=(0,t.oR)(),l=(0,t.I0)();return(0,s.useEffect)((()=>{const e=c.reducerManager.getMountedReducers();return Object.entries(r).forEach((([a,r])=>{e[a]||(c.reducerManager.add(a,r),l({type:`@INIT ${a} reducer`}))})),()=>{o&&Object.entries(r).forEach((([e,a])=>{c.reducerManager.remove(e),l({type:`@DESTROY ${e} reducer`})}))}}),[]),(0,n.jsx)(n.Fragment,{children:a})}},8312:function(e,a,r){r.d(a,{I:function(){return o}});var s=r(7294),t=r(3007),n=r(5893);const o=(0,s.memo)((e=>{const{className:a,value:r,onChange:o,type:c="text",placeholder:l,autofocus:u,readonly:d,...i}=e,m=(0,s.useRef)(null),[g,f]=(0,s.useState)(!1),[h,p]=(0,s.useState)(0),v=g&&!d;return(0,s.useEffect)((()=>{u&&(f(!0),m.current?.focus())}),[u]),(0,n.jsxs)("div",{className:(0,t.A)("LuFDUWoP",{},[a]),children:[l&&(0,n.jsx)("div",{className:"emAQQ85i",children:`${l}>`}),(0,n.jsxs)("div",{className:"y1GiFC_L",children:[(0,n.jsx)("input",{ref:m,type:c,value:r,onChange:e=>{o?.(e.target.value),p(e.target.value.length)},className:"LVdIPwcx",onFocus:()=>{f(!0)},onBlur:()=>{f(!1)},onSelect:e=>{p(e?.target?.selectionStart||0)},readOnly:d,...i}),v&&(0,n.jsx)("span",{className:"lqMFGBuL",style:{left:9*h+"px"}})]})]})}))}}]);