"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[517],{2517:(e,r,n)=>{n.r(r),n.d(r,{default:()=>S});var t=n(5861),a=n(4687),o=n.n(a),c=n(3007),s=n(4478),u=n(5255),l=n(8312),i=n(3942),d=n(7294),f=n(1715),v=n(1233),p=n(5401),m=function(e){var r;return(null==e||null===(r=e.loginForm)||void 0===r?void 0:r.username)||""},g=function(e){var r;return(null==e||null===(r=e.loginForm)||void 0===r?void 0:r.password)||""},h=function(e){var r;return(null==e||null===(r=e.loginForm)||void 0===r?void 0:r.isLoading)||!1},j=function(e){var r;return null==e||null===(r=e.loginForm)||void 0===r?void 0:r.error},x=n(4268),y=n(7081),b=n(1283),O=(0,x.hg)("login/loginByUsername",function(){var e=(0,t.Z)(o().mark((function e(r,n){var t,a,c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.extra,a=n.dispatch,c=n.rejectWithValue,e.prev=1,e.next=4,t.api.post("/login",r);case 4:if((s=e.sent).data){e.next=7;break}throw new Error;case 7:return localStorage.setItem(b.z,JSON.stringify(s.data)),a(y.hI.setAuthData(s.data)),e.abrupt("return",s.data);case 12:return e.prev=12,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",c("error"));case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(r,n){return e.apply(this,arguments)}}()),w=(0,x.oM)({name:"login",initialState:{isLoading:!1,username:"",password:""},reducers:{setUsername:function(e,r){e.username=r.payload},setPassword:function(e,r){e.password=r.payload}},extraReducers:function(e){e.addCase(O.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(O.fulfilled,(function(e){e.isLoading=!1})).addCase(O.rejected,(function(e,r){e.isLoading=!1,e.error=r.payload}))}}),N=w.actions,C=w.reducer;const P="PQPa1eB5";var k=n(5893),E={loginForm:C};const S=(0,d.memo)((function(e){var r=e.className,n=e.onSuccess,a=(0,s.$)().t,x=(0,p.T)(),y=(0,i.v9)(m),b=(0,i.v9)(g),w=(0,i.v9)(h),C=(0,i.v9)(j),S=(0,d.useCallback)((function(e){x(N.setUsername(e))}),[x]),F=(0,d.useCallback)((function(e){x(N.setPassword(e))}),[x]),I=(0,d.useCallback)((0,t.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(O({username:y,password:b}));case 2:"fulfilled"===e.sent.meta.requestStatus&&n();case 4:case"end":return e.stop()}}),e)}))),[n,x,b,y]);return(0,k.jsx)(v.W,{removeAfterUnmount:!0,reducers:E,children:(0,k.jsxs)("div",{className:(0,c.A)("xYNEfcE9",{},[r]),children:[(0,k.jsx)(f.xv,{title:a("Форма авторизации")}),C&&(0,k.jsx)(f.xv,{text:a("Вы ввели неверный логин или пароль"),theme:f.lg.ERROR}),(0,k.jsx)(l.I,{autofocus:!0,type:"text",className:P,placeholder:a("Введите username"),onChange:S,value:y}),(0,k.jsx)(l.I,{type:"text",className:P,placeholder:a("Введите пароль"),onChange:F,value:b}),(0,k.jsx)(u.zx,{theme:u.bn.OUTLINE,className:"Ok_5amJo",onClick:I,disabled:w,children:a("Войти")})]})})}))},1233:(e,r,n)=>{n.d(r,{W:()=>s});var t=n(9439),a=n(7294),o=n(3942),c=n(5893),s=function(e){var r=e.children,n=e.reducers,s=e.removeAfterUnmount,u=void 0===s||s,l=(0,o.oR)(),i=(0,o.I0)();return(0,a.useEffect)((function(){var e=l.reducerManager.getMountedReducers();return Object.entries(n).forEach((function(r){var n=(0,t.Z)(r,2),a=n[0],o=n[1];e[a]||(l.reducerManager.add(a,o),i({type:"@INIT ".concat(a," reducer")}))})),function(){u&&Object.entries(n).forEach((function(e){var r=(0,t.Z)(e,2),n=r[0];r[1],l.reducerManager.remove(n),i({type:"@DESTROY ".concat(n," reducer")})}))}}),[]),(0,c.jsx)(c.Fragment,{children:r})}},8312:(e,r,n)=>{n.d(r,{I:()=>f});var t=n(4942),a=n(9439),o=n(4925),c=n(3007),s=n(7294);var u=n(5893),l=["className","value","onChange","type","placeholder","autofocus","readonly"];function i(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function d(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?i(Object(n),!0).forEach((function(r){(0,t.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var f=(0,s.memo)((function(e){var r=e.className,n=e.value,i=e.onChange,f=e.type,v=void 0===f?"text":f,p=e.placeholder,m=e.autofocus,g=e.readonly,h=(0,o.Z)(e,l),j=(0,s.useRef)(null),x=(0,s.useState)(!1),y=(0,a.Z)(x,2),b=y[0],O=y[1],w=(0,s.useState)(0),N=(0,a.Z)(w,2),C=N[0],P=N[1],k=b&&!g;return(0,s.useEffect)((function(){var e;m&&(O(!0),null===(e=j.current)||void 0===e||e.focus())}),[m]),(0,t.Z)({},"fTN1PnWu",g),(0,u.jsxs)("div",{className:(0,c.A)("LuFDUWoP",{},[r]),children:[p&&(0,u.jsx)("div",{className:"emAQQ85i",children:"".concat(p,">")}),(0,u.jsxs)("div",{className:"y1GiFC_L",children:[(0,u.jsx)("input",d({ref:j,type:v,value:n,onChange:function(e){null==i||i(e.target.value),P(e.target.value.length)},className:"LVdIPwcx",onFocus:function(){O(!0)},onBlur:function(){O(!1)},onSelect:function(e){var r;P((null==e||null===(r=e.target)||void 0===r?void 0:r.selectionStart)||0)},readOnly:g},h)),k&&(0,u.jsx)("span",{className:"lqMFGBuL",style:{left:"".concat(9*C,"px")}})]})]})}))}}]);